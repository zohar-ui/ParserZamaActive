#!/bin/bash

# Post-commit hook - reminds to update docs after schema changes

# Check if any schema-related files were changed
SCHEMA_FILES_CHANGED=$(git diff --name-only HEAD~1 HEAD | grep -E '(golden_set/.*\.json|migrations/.*\.sql|STAGE2_PARSING|PARSER_AUDIT)' || true)

if [ -n "$SCHEMA_FILES_CHANGED" ]; then
    echo ""
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘  âš ï¸  SCHEMA CHANGE DETECTED                                   â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Files changed:"
    echo "$SCHEMA_FILES_CHANGED" | sed 's/^/  - /'
    echo ""
    echo "ğŸ“ Have you updated all related documentation?"
    echo ""
    echo "   Run checklist: ./scripts/schema_change_checklist.sh"
    echo ""
fi

exit 0
